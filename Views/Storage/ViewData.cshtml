@model ABCRetail.StorageDemo.Models.DataViewModel
@{
    ViewData["Title"] = "View All Data";
}

<h2>View All Stored Data</h2>

<!-- Navigation Tabs -->
<ul class="nav nav-tabs mb-4" id="dataTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="customers-tab" data-bs-toggle="tab" data-bs-target="#customers" type="button" role="tab">Customers (@Model.Customers.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="products-tab" data-bs-toggle="tab" data-bs-target="#products" type="button" role="tab">Products (@Model.Products.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="blobs-tab" data-bs-toggle="tab" data-bs-target="#blobs" type="button" role="tab">Media Blobs (@Model.Blobs.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="files-tab" data-bs-toggle="tab" data-bs-target="#files" type="button" role="tab">Contract Files (@Model.Files.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="queue-tab" data-bs-toggle="tab" data-bs-target="#queue" type="button" role="tab">Queue Messages (@Model.QueueMessages.Count)</button>
    </li>
</ul>

<!-- Tab Content -->
<div class="tab-content" id="dataTabsContent">
    <!-- Customers Tab -->
    <div class="tab-pane fade show active" id="customers" role="tabpanel">
        <h4>Customer Records</h4>
        <table class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Email</th>
                    <th>Partition Key</th>
                    <th>Row Key</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var customer in Model.Customers)
                {
                    <tr>
                        <td>@customer.FirstName</td>
                        <td>@customer.LastName</td>
                        <td>@customer.Email</td>
                        <td><code>@customer.PartitionKey</code></td>
                        <td><code>@customer.RowKey</code></td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Products Tab -->
    <div class="tab-pane fade" id="products" role="tabpanel">
        <h4>Product Catalog</h4>
        <table class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>Name</th>
                    <th>SKU</th>
                    <th>Price</th>
                    <th>Partition Key</th>
                    <th>Row Key</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var product in Model.Products)
                {
                    <tr>
                        <td>@product.Name</td>
                        <td><code>@product.Sku</code></td>
                        <td>@product.Price.ToString("C")</td>
                        <td><code>@product.PartitionKey</code></td>
                        <td><code>@product.RowKey</code></td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Blobs Tab -->
    <div class="tab-pane fade" id="blobs" role="tabpanel">
        <h4>Uploaded Media Files</h4>
        <table class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>File Name</th>
                    <th>Size</th>
                    <th>Last Modified</th>
                    <th>URL</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var blob in Model.Blobs)
                {
                    <tr>
                        <td>@blob.Name</td>
                        <td>@blob.FormattedSize</td>
                        <td>@blob.LastModified.LocalDateTime.ToString("g")</td>
                        <td><a href="@blob.Url" target="_blank">View File</a></td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Files Tab -->
    <div class="tab-pane fade" id="files" role="tabpanel">
        <h4>Contract Files (Azure Files)</h4>
        <table class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>File Name</th>
                    <th>Last Modified</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var file in Model.Files)
                {
                    <tr>
                        <td>@file.Name</td>
                        <td>@file.LastModified.LocalDateTime.ToString("g")</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Queue Tab -->
    <div class="tab-pane fade" id="queue" role="tabpanel">
        <h4>Recent Queue Messages</h4>
        <div class="alert alert-info">
            <i>Note: This shows the first 10 messages without removing them from the queue.</i>
        </div>
        <table class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>Message Content</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var message in Model.QueueMessages)
                {
                    <tr>
                        <td><code>@message</code></td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- Add a link back to the main page -->
<div class="mt-4">
    <a asp-action="Index" class="btn btn-secondary">Back to Main Page</a>
</div>

@section Scripts {
    <script>
        // Initialize the tabs if Bootstrap is used
        $(document).ready(function () {
            $('#dataTabs button').on('click', function (event) {
                event.preventDefault();
                $(this).tab('show');
            });
        });
    </script>
}